This document provides a comprehensive technical overview of the SIEM laboratory architecture, including component relationships, data flow, and system design decisions.




### Network Architecture

```
Internet
    │
    ▼
┌─────────────────────────────────────────────────────────────┐
│                    Local Network                           │
│                   (192.168.x.x)                           │
│                                                            │
│  ┌──────────────────┐              ┌──────────────────┐    │
│  │  Ubuntu VM       │              │  Windows 10      │    │
│  │  (SIEM Server)   │              │  Laptop          │    │
│  │                  │              │                  │    │
│  │  IP: 192.168.1.x │◄────────────►│  IP: 192.168.1.y│    │
│  │                  │   TCP/1514   │                  │    │
│  │  Ports:          │   TCP/1515   │  Services:       │    │
│  │  • 1514 (Agent) │              │  • Sysmon        │    │
│  │  • 1515 (Enroll)│              │  • Wazuh Agent   │    │
│  │  • 9200 (Index) │              │  • Windows Logs  │    │
│  │  • 443 (Web)    │              │                  │    │
│  │  • 55000 (API)  │              │                  │    │
│  └──────────────────┘              └──────────────────┘    │
│                                                            │
└─────────────────────────────────────────────────────────────┘
```

## 📊 Data Flow Architecture

### 1. Data Collection Layer

```
┌─────────────────────────────────────────────────────────────────┐
│                        Windows Endpoint                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │   System    │    │   Sysmon    │    │   Wazuh Agent       │  │
│  │   Events    │───▶│   Driver    │───▶│                     │  │
│  │             │    │             │    │ • Event Collection  │  │
│  │• Process    │    │• Enhanced   │    │ • Log Parsing       │  │
│  │  Creation   │    │  Logging    │    │ • Data Filtering    │  │
│  │• File I/O   │    │• Network    │    │ • Secure Transport  │  │
│  │• Registry   │    │  Monitoring │    │                     │  │
│  │• Network    │    │• Process    │    │                     │  │
│  │             │    │  Tracking   │    │                     │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│                                                  │               │
└──────────────────────────────────────────────────┼───────────────┘
                                                   │
                                        Encrypted TLS 1.2
                                                   │
                                                   ▼
```

### 2. Processing and Storage Layer

```
┌─────────────────────────────────────────────────────────────────┐
│                        Ubuntu SIEM Server                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────┐    ┌─────────────────────────────────┐ │
│  │   Wazuh Manager     │    │        Wazuh Indexer           │ │
│  │                     │    │                                 │ │
│  │ ┌─────────────────┐ │    │ ┌─────────────────────────────┐ │ │
│  │ │ Event Receiver  │◄┼────┤ │      Data Storage           │ │ │
│  │ │ (Port 1514)     │ │    │ │                             │ │ │
│  │ └─────────────────┘ │    │ │ • Time-series Indexing      │ │ │
│  │          │          │    │ │ • Full-text Search          │ │ │
│  │          ▼          │    │ │ • Data Compression          │ │ │
│  │ ┌─────────────────┐ │    │ │ • Retention Policies        │ │ │
│  │ │  Rule Engine    │ │    │ └─────────────────────────────┘ │ │
│  │ │                 │ │    │              ▲                  │ │
│  │ │ • Pattern Match │ │    └──────────────┼──────────────────┘ │
│  │ │ • Correlation   │ │                   │                    │
│  │ │ • Enrichment    │ │                   │                    │
│  │ │ • Alerting      │ │───────────────────┘                    │
│  │ └─────────────────┘ │                                        │
│  └─────────────────────┘                                        │
└─────────────────────────────────────────────────────────────────┘
```

### 3. Presentation Layer

```
┌─────────────────────────────────────────────────────────────────┐
│                     Web Interface Layer                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────┐    ┌─────────────────────────────────┐ │
│  │  Wazuh Dashboard    │    │         RESTful API             │ │
│  │                     │    │                                 │ │
│  │ • Real-time Views   │◄───┤ • Agent Management             │ │
│  │ • Security Events   │    │ • Configuration Control        │ │
│  │ • Agent Monitoring  │    │ • Rule Management               │ │
│  │ • Alert Management  │    │ • System Health Monitoring     │ │
│  │ • Search Interface  │    │ • Automated Responses          │ │
│  │ • Custom Dashboards│    │                                 │ │
│  └─────────────────────┘    └─────────────────────────────────┘ │
│                                                                 │
│              ▲                                                  │
│              │                                                  │
│         HTTPS (Port 443)                                        │
│              │                                                  │
│              ▼                                                  │
│    ┌─────────────────────────────────────────────────────────┐  │
│    │              End User Browser                           │  │
│    │                                                         │  │
│    │ • Security Analyst Workstation                         │  │
│    │ • SOC Operations Dashboard                              │  │
│    │ • Incident Response Interface                           │  │
│    └─────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## 🔍 Event Processing Pipeline

### Sysmon Event Categories

| Event ID | Category            | Security Value                 | Volume  |
|----------|---------------------|--------------------------------|---------|
| **1**    | Process Creation    | Critical - Malware detection   | High    |
| **3**    | Network Connection  | High - C2 communication        |  Medium |
| **11**   | File Creation       | Medium - Payload detection     | High    |
| **12/13**| Registry Changes    | Medium - Persistence detection | Medium  |
| **8**    | CreateRemoteThread  | High - Process injection       | Low     |
| **10**   | Process Access      | Medium - Credential theft      | Medium  |
| **15**   | File Stream Created | Low - ADS detection            | Low     |

### Processing Stages

```
Raw Sysmon Event
        │
        ▼
┌───────────────────┐
│   Agent Parsing   │ ◄── Local filtering and normalization
│                   │
└───────────────────┘
        │
        ▼ (TLS Transport)
┌───────────────────┐
│  Manager Intake   │ ◄── Receiving and initial validation
│                   │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│  Rule Processing  │ ◄── Pattern matching and correlation
│                   │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│   Enrichment      │ ◄── Add context and metadata
│                   │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│   Indexing        │ ◄── Store in searchable format
│                   │
└───────────────────┘
        │
        ▼
┌───────────────────┐
│   Alerting        │ ◄── Generate alerts for SOC
│                   │
└───────────────────┘
```



### Authentication and Authorization

┌─────────────────────────────────────────────────────────────────┐
│                    Security Controls                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌──────────────┐ │
│  │  Agent Auth     │    │  Dashboard Auth │    │  API Auth    │ │
│  │                 │    │                 │    │              │ │
│  │ • Pre-shared    │    │ • Username/Pass │    │ • JWT Token  │ │
│  │   Keys          │    │ • RBAC          │    │ • API Keys   │ │
│  │ • Certificate   │    │ • Session Mgmt  │    │ • OAuth 2.0  │ │
│  │   Validation    │    │ • MFA Support   │    │              │ │
│  └─────────────────┘    └─────────────────┘    └──────────────┘ │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                  Transport Security                         │ │
│  │                                                             │ │
│  │ • TLS 1.2+ for all communications                          │ │
│  │ • Certificate-based agent authentication                   │ │
│  │ • HTTPS for web dashboard access                           │ │
│  │ • Encrypted agent-manager communication                    │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### Network Security Model

| Component | Protocol | Port | Security | Purpose |
|-----------|----------|------|----------|---------|
| **Agent Communication** | TCP | 1514 | TLS 1.2 | Log forwarding |
| **Agent Enrollment** | TCP | 1515 | TLS 1.2 | Initial registration |
| **Dashboard Access** | HTTPS | 443 | TLS 1.2 | Web interface |
| **API Access** | HTTPS | 55000 | TLS 1.2 | Management API |
| **Indexer** | HTTPS | 9200 | TLS 1.2 | Internal communication |

## 📈 Performance Architecture

### Scalability Design

```
┌─────────────────────────────────────────────────────────────────┐
│                    Scalability Considerations                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Current Lab Scale:                                             │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ • 1-2 Windows endpoints                                     │ │
│  │ • ~1,000 events per hour                                    │ │
│  │ • Single-node deployment                                    │ │
│  │ • Development/Learning environment                          │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
│  Enterprise Scale Capability:                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ • 1,000+ endpoints                                          │ │
│  │ • 100,000+ events per second                                │ │
│  │ • Multi-node cluster deployment                             │ │
│  │ • Production SOC environment                                │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘



## 🔧 Deployment Architecture

### Infrastructure Requirements

```
┌─────────────────────────────────────────────────────────────────┐
│                    Physical Infrastructure                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Development Environment (Current):                            │
│  ┌─────────────────┐              ┌─────────────────────────┐   │
│  │  Mac M1 Host    │              │  Physical Hardware      │   │
│  │                 │              │                         │   │
│  │ ┌─────────────┐ │              │ ┌─────────────────────┐ │   │
│  │ │ Ubuntu VM   │ │              │ │   Windows 10        │ │   │
│  │ │ (UTM)       │ │              │ │   Laptop            │ │   │
│  │ │             │ │              │ │                     │ │   │
│  │ │ • Wazuh     │ │◄────────────►│ │ • Sysmon           │ │   │
│  │ │   Server    │ │   Network    │ │ • Wazuh Agent      │ │   │
│  │ │ • 4GB RAM   │ │              │ │                     │ │   │
│  │ │ • 50GB SSD  │ │              │ │                     │ │   │
│  │ └─────────────┘ │              │ └─────────────────────┘ │   │
│  └─────────────────┘              └─────────────────────────┘   │
│                                                                 │
│  Production Considerations:                                     │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ • Dedicated server hardware                                 │ │
│  │ • High-availability clustering                              │ │
│  │ • Load balancing for dashboard access                       │ │
│  │ • Centralized storage (SAN/NAS)                            │ │
│  │ • Network monitoring and redundancy                         │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 Architectural Benefits

### Design Advantages

| Benefit | Description | Business Value |
|---------|-------------|----------------|
| **Centralized Monitoring** | Single pane of glass for security events | Improved analyst efficiency |
| **Real-time Detection** | Sub-second event processing and alerting | Faster incident response |
| **Scalable Architecture** | Horizontal scaling capability | Growth accommodation |
| **Open Source Foundation** | No licensing costs, full customization | Cost-effective deployment |
| **API-driven Management** | Automation and integration capabilities | Operational efficiency |

### Technical Strengths

- **Agent-based Collection**: Reliable data collection even with network issues
- **Rule-based Processing**: Flexible detection logic and correlation
- **REST API Integration**: Easy integration with other security tools
- **Multi-platform Support**: Windows, Linux, macOS, and cloud environments
- **Compliance Ready**: Built-in compliance reporting (PCI DSS, GDPR, HIPAA)

## 🔮 Future Architecture Enhancements

### Planned Improvements

```
Phase 1: Enhanced Detection
├── Custom Sigma rule development
├── Threat intelligence feed integration
├── Machine learning anomaly detection
└── Automated response playbooks

Phase 2: Enterprise Features
├── Multi-tenant deployment
├── High availability clustering
├── Advanced visualization dashboards
└── Compliance automation

Phase 3: Advanced Integration
├── SOAR platform connectivity
├── Vulnerability management integration
├── Cloud security monitoring
└── Endpoint response capabilities
```

## 📊 Monitoring and Observability

### System Health Metrics

| Metric Category | Key Indicators | Monitoring Method |
|-----------------|---------------|-------------------|
| **Agent Health** | Connection status, event rate | Dashboard alerts |
| **Server Performance** | CPU, memory, disk usage | System monitoring |
| **Event Processing** | Queue depth, processing latency | Wazuh statistics |
| **Storage Usage** | Index size, retention compliance | Automated cleanup |
| **Network Health** | Bandwidth utilization, packet loss | Network monitoring |

### Operational Dashboards

- **SOC Overview**: High-level security metrics and alerts
- **Agent Status**: Endpoint connectivity and health monitoring  
- **Event Analytics**: Trend analysis and pattern detection
- **System Performance**: Infrastructure health and capacity planning
- **Compliance Reporting**: Regulatory requirement tracking

***

## 🎯 Architecture Summary

This SIEM laboratory demonstrates a production-ready architecture with:

- **Robust Data Collection**: Comprehensive endpoint monitoring with Sysmon
- **Scalable Processing**: Event correlation and analysis engine
- **Flexible Storage**: Time-series indexing with full-text search
- **Intuitive Interface**: Web-based security operations dashboard
- **API Integration**: Automation and third-party tool connectivity
- **Security-first Design**: Encrypted communications and authentication

The architecture provides a solid foundation for cybersecurity operations while maintaining the flexibility to scale and adapt to changing security requirements.

***

**This architecture design reflects enterprise-grade security monitoring capabilities implemented in a laboratory environment for learning and development purposes.**

